# chatgptは0秒で起動する月額3000円のlinux仮想環境だった

先日「要件定義からテストしてドキュメントまで作成してくれるAIいないかなー」という話がでまして
そんな都合の良い話は無いと思ったんですが居ました、chatgptって言うんですけど
はじめにつらつら前置きを書いてますので、やり方だけ知りたい人は「3. 手順」に飛んでください
※この記事はchatgptの会話内容、スクリーンショットを使用しています

## 1. スマホで指一本で起動する"linux仮想環境"

*指一本で、0秒なんですよ。*
*そう、chatgptならね。*

これに気付いた時すなわち今日、衝撃でした
いや知ってる人は大勢いると思うので「今更かよｗ」かもしれませんが
いいんですよ私が気付いたのは今日なので

今まで仮想立ててなんかやろーと思うときは
1. 起きます
2. 電気湯沸かし器に水を300ml入れます
3. 電気湯沸かし器をonにします
4. PCの前に座ります
5. PCを起動します
6. PCにログインします
7. 仮想環境を立てるやつを起動します
8. お湯がわいているのでカップ麺に注ぎます
9. 仮想環境起動を開始します
10. ちょっとSNS見ます
11. カップ麺を食います
12. 仮想環境が起動しました

これくらいの手間と時間がかかったわけですよ
それがなんとchatgptなら

1. **スマホでchatgptアプリを起動する**
2. **仮想環境設定用文章をコピペして送信**

これだけで済んでしまうんです
スマホは寝ている時も持っているので**起きます**すらないです
まぁ0秒はちょっと盛りました
正確には2工程で、コピペして送信する時間も含めて10秒程度です
これだけで「要件定義してテストしてドキュメントまで作成して」で全部やってくれちゃいます

## 2. linux仮想環境としてのchatgpt
使い方詳細です
仕様がよく変わるのであくまで今日（2025-06-07）時点の情報です
あとあまり関係ないかもしれませんが月額3000円とタイトルにあるとおりplusユーザーです

必要な材料と結果はgitの方に置いておきましたので参考までに
今回はjsonファイルのcsv変換をやってみました
json-flattener-poc(https://github.com/karine-mue/json-flattener-poc/tree/main)

### 2-1. できること
Pythonと標準ライブラリと一部のlinuxコマンドが使えます

- **使えるPythonライブラリ**
  - 標準ライブラリ: os, sys, datetimeなど
  - OS操作系: subprocess, shutil, zipfile, pathlibなど
  - pandas: 一部制約有り
    あまりデータが大きすぎると無理
    pandas-stubsや依存ライブラリが必要で入れられないもの（openpyxl, pyarrowなど）は不可
  - numpy: 軽量版が使える
  - matplotlib: おえかき
</br>
- **使えないPythonライブラリ**
pipで入れなければならないものは無理で、使えないもののうち有名どころはこんな感じです
  - scipy: 意外ですが使えません
  - sklearn: そもそも長時間回せないですしね
  - requests: オンラインに出られないので無理
  - flask, fastapiなど: サーバ系も無理
</br>
- **使えるLinuxコマンド**
pythonの`subprocess`経由でlinuxコマンドを実行します
使える代表的なコマンドは以下です
  - ファイル操作: ls, find, cat, du, cp, mv, rm
  - テキスト処理: head, tail, wc, sort, grep(アクセス不可のディレクトリはNG)
  - 圧縮処理: zip, unzip
  - pythonスクリプト呼び出し: python3
  - システム状態: df, uptime, whoami(仮想環境制約あり)
</br>
- **使えないLinuxコマンド**
大体想像つくかと思いますが使えない代表的なコマンドはこんな感じです
  - ネットワーク関連（オフラインなので）: ping, curl, wget, hostname
  - システム操作（制限付き環境）: ps, top, netstat, ip, ipconfig
  - デーモン・ユーザ（仮想環境なのでプロセス情報や実ユーザ無し）: who, id, groups, sudo, systemctl
</br>
- **使えるディレクトリ**
「え？dfいけんの！？」と思ってびっくりして試してみたら本当に出来るんですよね…
「`df -h`を実行して」と頼んだらこれを実行して返してきました
`subprocess.run(["df", "-h"], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)`
マジですか…
尚、サンドボックス内のディレクトリの`/mnt/data`配下はユーザが自由に使えます
ちなみに他のディレクトリ構造も教えてもらえるのかなぁと聞いたところ、それは流石にNGでした
ただ教えられないディレクトリとして「home, etc, usrは教えられない」と
いや、それ言ってしまっているけどいいのかな？
まぁlinuxのroot配下の一般的なディレクトリだからいいのかな
</br>
- **使える容量**
気になる容量ですが"本人"が言うには「**4GB**ぐらいがギリギリかな～…」とのことでした
ただファイルの種類（処理の種類）にもよるようで「画像多めだときついかも」、と
あまり重い画像ファイルは置かない方がよさそうです

### 2-2. できないこと
当然できないこともあります
- **セッションが終了すると消えます**
これが一番大きいです
まぁそれはそう…メイン機能は対話AIなんで…
</br>
- **cronの定時実行**
定時実行も無理ですね、終わったら消えちゃうので
</br>
- **オンラインには出られない**
上でも触れていますが実行環境自体はサンドボックス内の仮想環境なのでwebには出られません
</br>
- **他の言語での実行**
Python tool経由で実行していて、linuxも`subprocess`を使っているので他の言語は未対応です
でももしかしたら今後対応言語は増えるかもしれませんね
</br>
- **JST対応**
後述するプロンプトの中で日本標準時をお願いしているんですが反映されないんですよね
サーバがアメリカにあるから、というのが大きそうですが私の指示次第で解決できそうな気もします

### 2-3. できないことが多い理由

そもそも"対話AI"でレスポンスを最優先しているからです
機能を極限まで絞って起動に時間をかけないUX設計、ということですね
どうやらchatgptは以下のような動きをしているようです
一応"本人"に確認したところ合っているとのことですが推測成分が多いのであくまで参考として

**コード生成が早い理由**
1. **新規会話開始**
まず軽量なフロントUI（チャットの入力画面）を表示
表ではユーザが入力をしているのでそこで時間を稼ぎます
<br>
2. **準備完了**
ユーザから一回目の入力でコード関連の話をされた場合、pythonを使うかも？と判断仮想環境をトリガ
ディレクトリは特定のもののみ、webアクセスなし、パッケージ固定でpipは不可なのは短時間で用意するためです
非同期でサンドボックスを起動、コードを実行するためのディレクトリが使えるようになります
表ではどういうものを作ってほしいか、という会話が進んでいます
そしてコード作成のタイミングでは既に作成が実行できるようになっている、という寸法です

これ面白いのは人間の思考時間も計算に入っているところですね
何かを作ってもらうときに「なんて言おうかな…」と少なからず考えるので、それで時間が稼げます
これはゲームの設計と同じで、例えば次の扉を抜けるとエリアが変わるという時には既に読み込みをはじめて実際に扉を開いた後の体感的な待機時間を短くするという手法と同じものです

## 3. 手順 
それじゃ実際どうやってlinux仮想環境として使うの？というお話です
### 3-1. "指示"（共通プロンプトの記載）**
さて、プロジェクトを開く or 作成すると「指示」を書くことができます
ここに共通する応答方法、いわゆるプロンプトを書きます
このプロンプト内にディレクトリ構造やバージョン管理方法を入れ込んでおきます
参考までに私のプロンプトはこちら
→ project_rules.md (https://github.com/karine-mue/json-flattener-poc/blob/main/project_rules.md)

### 3-2. "指示"の実行
ここからは個別会話の中に入ります
残念ながら"指示"に書いておいても「"指示"を読んでその通りに作って」では現状展開されないようです
そのため"指示"は最初の段階ではコピペするためのメモ書きです
人間が入力する必要があるので、個別会話の最初の入力に`project_rules.md`の内容（"指示"に入れたもの）を貼り付けて送信すると
`/mnt/data`の下にappディレクトリ他一式が作成されます

### 3-3. 作成
あとは作ってほしいものを入力するだけです
例えばこんな感じ

- 処理内容: jsonからcsvへの変換処理
- 入力: テストファイルの作成もお願い、動くかどうかの確認だからそんなに大きくなくていいよ
- 出力: アウトプットのファイル形式を指定（毎回同じなら共通に入れ込んでもいい）
- log(+標準出力): どのようにlogを出すか、特に指定がなければ"指示通り"

これだけで実装からテストまでやってくれます
かかった時間は2～3秒
やばくないですか？やばいです
実際のところはこれだけでは思った通りにならなくてこの後修正指示を何回かしてはいるのですが

特に地味にめんどくさい**テストデータの作成**が全自動でできるのがやばい
これ今回は設計→実装→テストまでオートメーションができるかどうかのテストだったので、
テスト設計はしてないんですがやろうと思えばそこから出来てしまいますね
簡単な物ならもはや人間要らないかも？
人間は机の下に潜ってLANケーブルを配線する作業を頑張ります

### 3-4. 次回へ持ち越すにはセーブをこまめに（最重要）
これが何気に一番大事かもしれません
最大のデメリット、**chatgptはセッションが切れると仮想空間が破棄されます**
なんか全部ではないにしてもちょいちょい消えるんですよね
さすがに連続して対話している最中に消えはしないのですが
対策としては**appを丸ごとzipにしてダウンロードリンクでください**と伝えるという地味な方法になります
また、一回で終わらずちょっと時間をおいて続けるにはローカルルールを書き出しておくとよいです
例えばこのような感じで書き出しておくと次回開始した時同様に以下の順番で渡すことで続きから始められます
→ prompt_flattening.md(https://github.com/karine-mue/json-flattener-poc/blob/main/prompt_flattening.md)

**次回続きから始めるときには**
1. "指示"にある内容（共通ルール）を最初に提示する
2.  app.zipをアップロード（`/mnt/data/app/` に展開される）
3.  ローカルプロンプト（個別ルール）を送信し、構成と意図を伝える

## 4. おわりに
これって"便利"なの？と考えるとちょっと微妙だなぁ感は正直あります
PCで仮想環境を持ってれば自前でやった方が取り回しは便利ですしね
ただ、chatgptなんで伝達はコマンドで投げてもいいし自然言語でもいい
話しながら、作りながら考えて実行したい、そういう時には最高の相棒になります
PCを開かなくても電車の中でも、いいアイデアが思いついたらとりあえずスマホからプロトタイプを作っておいてzipで送る
そんなことが出来る時代になりました、すごいですね
しかも友達代月額3000円の範囲内で
ではまた今度


